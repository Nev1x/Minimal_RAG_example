```markdown
# RAG –ø–æ FAQ –ê–ª—å—Ñ–∞-–ë–∞–Ω–∫–∞ (ROSBERTa + Mistral + Qdrant)

–°–∏—Å—Ç–µ–º–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –º–æ–∂–Ω–æ –ª–∏ –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å –Ω–∞ –æ—Å–Ω–æ–≤–µ –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π (CSV), –∏ –µ—Å–ª–∏ –¥–∞ ‚Äî –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ç–æ—á–Ω—ã–π –æ—Ç–≤–µ—Ç.

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**: ROSBERTa ‚Üí —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ ‚Üí Qdrant (–ø–æ–∏—Å–∫ –ø–æ –∫–æ—Å–∏–Ω—É—Å–Ω–æ–π –±–ª–∏–∑–æ—Å—Ç–∏) ‚Üí Mistral (–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞).

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```bash
# 1) –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install -U python-dotenv openai qdrant-client pandas tqdm huggingface_hub

# 2) –ó–∞–ø–æ–ª–Ω–∏—Ç—å .env –∏–∑ .env.example (—Å–º. –Ω–∏–∂–µ)

# 3) –ü–æ–¥–Ω—è—Ç—å Qdrant –ª–æ–∫–∞–ª—å–Ω–æ
docker-compose up -d   # UI: http://localhost:6333/dashboard

# 4) –ó–∞–≥—Ä—É–∑–∏—Ç—å –±–∞–∑—É –∑–Ω–∞–Ω–∏–π –≤ Qdrant
python upload_context.py

# 5) –ó–∞–ø—É—Å—Ç–∏—Ç—å RAG-CLI
python main.py
```

---

## üß© –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –Ω–∞ –æ—Å–Ω–æ–≤–µ `.env.example`:

```env
# === .env ===
HF_TOKEN=—Å—é–¥–∞_–≤–∞—à_hf_—Ç–æ–∫–µ–Ω
BASE_URL=—Å—é–¥–∞_–≤–∞—à_base_url
MAIN_MODEL=—Å—é–¥–∞_–≤–∞—à—É_–æ—Å–Ω–æ–≤–Ω—É—é_llm_–º–æ–¥–µ–ª—å
EMBEDDING_MODEL=—Å—é–¥–∞_–≤–∞—à—É_–æ—Å–Ω–æ–≤–Ω—É—é_embedding_–º–æ–¥–µ–ª—å
QDRANT_URL=—Å—é–¥–∞_qdrant_url
COLLECTION_NAME=—Å—é–¥–∞_–Ω–∞–∑–≤–∞–Ω–∏–µ_–∫–æ–ª–ª–µ–∫—Ü–∏–∏_–¥–ª—è_–±–¥
DATA_PATH=—Å—é–¥–∞_–ø—É—Ç—å_–¥–æ_–¥–∏—Ä—Ä–µ–∫—Ç–æ—Ä–∏–∏_—Å_–∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–º–∏_–¥–∞–Ω–Ω—ã–º–∏

# –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ:
# SIMILARITY_THRESHOLD=0.4
# TOP_K=3
# DEBUG=1
```

**–ü–æ—è—Å–Ω–µ–Ω–∏—è:**
- `HF_TOKEN` ‚Äî —Ç–æ–∫–µ–Ω Hugging Face (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ –∏ –∫–∞–∫ api_key –¥–ª—è LLM)
- `BASE_URL` ‚Äî OpenAI-—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç –¥–ª—è Mistral (–Ω–∞–ø—Ä–∏–º–µ—Ä, `http://localhost:11434/v1`)
- `MAIN_MODEL` ‚Äî –∏–º—è –º–æ–¥–µ–ª–∏ –Ω–∞ —ç–Ω–¥–ø–æ–∏–Ω—Ç–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `mistral-7b-instruct`)
- `EMBEDDING_MODEL` ‚Äî `ai-forever/ru-en-RoSBERTa`
- `QDRANT_URL` ‚Äî –æ–±—ã—á–Ω–æ `http://localhost:6333`
- `COLLECTION_NAME` ‚Äî –∏–º—è –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –≤ Qdrant
- `DATA_PATH` ‚Äî –ø—É—Ç—å –∫ `data/knowledge_base_300_extended.csv`

---

## üóÇÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
.
‚îú‚îÄ‚îÄ docker-compose.yml
‚îú‚îÄ‚îÄ .env
‚îú‚îÄ‚îÄ .env.example
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îî‚îÄ‚îÄ knowledge_base_300_extended.csv
‚îú‚îÄ‚îÄ embeddings.py                # ROSBERTa —á–µ—Ä–µ–∑ HF Inference API
‚îú‚îÄ‚îÄ upload_context.py            # –∑–∞–≥—Ä—É–∑–∫–∞ CSV –≤ Qdrant (1 FAQ = 1 —á–∞–Ω–∫)
‚îú‚îÄ‚îÄ utils/
‚îÇ   ‚îî‚îÄ‚îÄ text_processing.py       # clean_text()
‚îî‚îÄ‚îÄ main.py                      # –ø–æ–∏—Å–∫ –≤ Qdrant + –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞ (RAG)
```

**UI Qdrant**: http://localhost:6333/dashboard

---

## üß± –ó–∞–≥—Ä—É–∑–∫–∞ –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π

```bash
python upload_context.py
```

- –ß–∏—Ç–∞–µ—Ç CSV –∏–∑ `DATA_PATH`
- –°—Ç—Ä–∞—Ç–µ–≥–∏—è: 1 FAQ = 1 —á–∞–Ω–∫ (–≤–æ–ø—Ä–æ—Å + –æ—Ç–≤–µ—Ç ‚Üí –æ–¥–∏–Ω –≤–µ–∫—Ç–æ—Ä)
- –í payload –≤ Qdrant –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è: `question`, `answer`, `category`, `chunk_index`

> –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å–∫—Ä–∏–ø—Ç –ø–µ—Ä–µ—Å–æ–∑–¥–∞—ë—Ç –∫–æ–ª–ª–µ–∫—Ü–∏—é. –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –Ω–µ —É–¥–∞–ª—è—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é ‚Äî –∑–∞–º–µ–Ω–∏—Ç–µ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏–µ –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

---

## üß† –ü–æ–∏—Å–∫ –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è (RAG)

```bash
python main.py
```

**–ü–∞–π–ø–ª–∞–π–Ω:**
1. –≠–º–±–µ–¥–¥–∏–Ω–≥ –∑–∞–ø—Ä–æ—Å–∞ —á–µ—Ä–µ–∑ ROSBERTa (`embeddings.py`)
2. –ü–æ–∏—Å–∫ top-K –∑–∞–ø–∏—Å–µ–π –≤ Qdrant (`Distance.COSINE` ‚Üí –∫–æ—Å–∏–Ω—É—Å–Ω–∞—è –±–ª–∏–∑–æ—Å—Ç—å, `score ‚àà [0..1]`)
3. –°–±–æ—Ä —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –∏ —Å–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç
4. –í—ã–∑–æ–≤ Mistral —á–µ—Ä–µ–∑ OpenAI-—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π `BASE_URL`
5. –û—á–∏—Å—Ç–∫–∞ —Ç–µ–∫—Å—Ç–∞ (`utils/text_processing.py::clean_text`)

---

## üîé –ü—Ä–∏–º–µ—Ä—ã –≤–æ–ø—Ä–æ—Å–æ–≤

**–°–º–æ–∂–µ—Ç –æ—Ç–≤–µ—Ç–∏—Ç—å** (–µ—Å—Ç—å –≤ CSV –∫–∞–∫ FAQ-—Ç–µ–º—ã):
- ¬´–ö–∞–∫ –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –¥–µ–Ω—å–≥–∏ –Ω–∞ –¥—Ä—É–≥—É—é –∫–∞—Ä—Ç—É —á–µ—Ä–µ–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ê–ª—å—Ñ–∞-–ë–∞–Ω–∫–∞?¬ª
- ¬´–ö–∞–∫ –æ—Ç–∫—Ä—ã—Ç—å –≤–∫–ª–∞–¥ –æ–Ω–ª–∞–π–Ω?¬ª

**–ù–µ —Å–º–æ–∂–µ—Ç** (–Ω–µ—Ç –≤ –±–∞–∑–µ / –Ω—É–∂–Ω—ã –≤–Ω–µ—à–Ω–∏–µ –¥–∞–Ω–Ω—ã–µ):
- ¬´–í–æ —Å–∫–æ–ª—å–∫–æ –∑–∞–≤—Ç—Ä–∞ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –æ—Ç–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ —É–ª. –õ–µ–Ω–∏–Ω–∞, 25 –≤ –ö–∏—Ä–æ–≤–µ?¬ª
- ¬´–ö–∞–∫–æ–π –±–∞–ª–∞–Ω—Å –Ω–∞ –º–æ–µ–π –∫–∞—Ä—Ç–µ / —Ç–µ–∫—É—â–∏–π –Ω–∞–ª–∏—á–Ω—ã–π –∫—É—Ä—Å –µ–≤—Ä–æ?¬ª

> –ü—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ —Å–∏—Å—Ç–µ–º–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç–≤–µ—á–∞–µ—Ç, —á—Ç–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –Ω–µ—Ç.

---

## ‚öôÔ∏è –î–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

- **–≠–º–±–µ–¥–¥–∏–Ω–≥–∏**: Hugging Face Inference API (`EMBEDDING_MODEL=ai-forever/ru-en-RoSBERTa`)
- **–í–µ–∫—Ç–æ—Ä–Ω–∞—è –ë–î**: Qdrant —Å `Distance.COSINE`
- **LLM**: Mistral (—á–µ—Ä–µ–∑ `OpenAI(base_url=..., api_key=HF_TOKEN)`)
- **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏**: `SIMILARITY_THRESHOLD` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 0.4)
- **Top-K –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–≤**: `TOP_K` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 3)

---

## üìà –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ (–Ω–∞ –±—É–¥—É—â–µ–µ)

- **–î–æ ~1000 FAQ** ‚Äî 1 FAQ = 1 —á–∞–Ω–∫ (–ø—Ä–æ—Å—Ç–æ –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ)
- **10k+ FAQ** ‚Äî —á–∞–Ω–∫–∏–Ω–≥ –æ—Ç–≤–µ—Ç–æ–≤ –ø–æ —Å–º—ã—Å–ª—É (‚âà400‚Äì500 —Å–∏–º–≤–æ–ª–æ–≤, overlap ‚âà 30‚Äì50), —Ö—Ä–∞–Ω–∏—Ç—å `faq_id`, –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —á–∞–Ω–∫–æ–≤ –æ–¥–Ω–æ–≥–æ FAQ –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–∞
- **–ü—Ä–∏ –º–∞—Å—Å–æ–≤–æ–π –∑–∞–≥—Ä—É–∑–∫–µ** ‚Äî —Ä–µ—Ç—Ä–∞–∏/–±–∞—Ç—á–∏ –¥–ª—è —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ –∏–ª–∏ –ª–æ–∫–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å —á–µ—Ä–µ–∑ `sentence-transformers`

---

## üõ†Ô∏è –¢—Ä–∞–±–ª—à—É—Ç–∏–Ω–≥

- **¬´*.env –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã¬ª** ‚Üí –ø—Ä–æ–≤–µ—Ä—å .env –∏ –ø—É—Ç—å –∑–∞–ø—É—Å–∫–∞
- **¬´Qdrant –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç¬ª** ‚Üí –ø–æ–¥–Ω–∏–º–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—Ä—Ç 6333
- **¬´–ö–æ–ª–ª–µ–∫—Ü–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω–∞¬ª** ‚Üí —Å–Ω–∞—á–∞–ª–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ `upload_context.py`
- **¬´429/—Ç–∞–π–º–∞—É—Ç—ã HF Inference¬ª** ‚Üí —É–º–µ–Ω—å—à–∏—Ç–µ —Å–∫–æ—Ä–æ—Å—Ç—å, –¥–æ–±–∞–≤—å—Ç–µ —Ä–µ—Ç—Ä–∞–∏ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ª–æ–∫–∞–ª—å–Ω—ã–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏

---
